<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Market Pulse – Dubai Grains Real-Time Prices</title>
  <meta name="description" content="Live grain prices from Jebel Ali, Al Ras. Verified suppliers. Daily trends, origin filters, AI insights." />
  <meta name="keywords" content="grain prices, Dubai market, Jebel Ali, Al Ras, Basmati, Irri 6, FCL, real-time" />
  <meta name="author" content="Shahid Bashir" />
  <link rel="canonical" href="https://grains.ae/pulse" />
  <link rel="icon" href="../favicon.png" type="image/png" />

  <!-- OG Tags -->
  <meta property="og:title" content="Market Pulse – Live Grain Prices in Dubai" />
  <meta property="og:description" content="Real-time prices from Jebel Ali & Al Ras. Verified suppliers. AI-powered insights." />
  <meta property="og:image" content="https://grains.ae/assets/img/og-pulse.jpg" />
  <meta property="og:url" content="https://grains.ae/pulse" />
  <meta name="twitter:card" content="summary_large_image" />

  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "name": "Market Pulse",
    "description": "Real-time grain prices from Dubai's Jebel Ali and Al Ras markets.",
    "url": "https://grains.ae/pulse"
  }
  </script>

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { background:#fdfdf9; font-family:'Helvetica Neue',sans-serif; color:#222; line-height:1.7; }

    /* ---------- NAVBAR (MATCHES HOMEPAGE) ---------- */
    .navbar {
      background:#C1A875; padding:12px 20px; position:sticky; top:0; z-index:1000;
      display:flex; justify-content:center; align-items:center;
      box-shadow:0 2px 10px rgba(0,0,0,.1); gap:40px;
      flex-wrap:wrap;
    }
    .logo {
      color:#fff; font-weight:bold; font-size:1.1rem; text-decoration:none;
      display:flex; align-items:center; gap:8px;
    }
    .logo img { width:24px; height:24px; }
    .nav-links {
      display:flex; list-style:none; gap:20px; margin:0; padding:0;
    }
    .nav-links a {
      color:#fff; text-decoration:none; font-size:14px; font-weight:bold;
      padding:8px 12px; border-radius:4px;
      transition:background 0.3s ease, color 0.3s ease;
    }
    .nav-links a:hover {
      background:#fff; color:#C1A875;
    }
    .nav-links a.active {
      background:#fff; color:#C1A875;
    }

    .hamburger { 
      display:none; flex-direction:column; cursor:pointer; gap:5px; 
    }
    .hamburger span { width:25px; height:3px; background:#fff; border-radius:2px; }

    @media (max-width:768px) {
      .navbar { justify-content:space-between; padding:10px 16px; gap:0; }
      .logo { font-size:1rem; }
      .hamburger { display:flex; }
      .nav-links {
        position:absolute; top:100%; left:0; right:0; background:#C1A875;
        flex-direction:column; padding:0; margin:0;
        max-height:0; overflow:hidden; transition:max-height .35s ease;
        box-shadow:0 4px 10px rgba(0,0,0,.1);
      }
      .nav-links.active { max-height:500px; }
      .nav-links a {
        text-align:center; width:100%; padding:14px;
        border-bottom:1px solid rgba(255,255,255,.1);
      }
    }

    /* ---------- HERO ---------- */
    header {
      padding:100px 20px 80px;
      background:url('../assets/img/pulse-hero.jpg') center/cover no-repeat;
      position:relative; color:#fff; text-align:center;
    }
    header::before { content:''; position:absolute; inset:0; background:rgba(0,0,0,.55); }
    header > * { position:relative; z-index:1; }
    header img { width:140px; margin-bottom:16px; }
    header h1 { font-size:38px; font-weight:500; margin-bottom:12px; }
    header p { font-size:18px; max-width:700px; margin:10px auto; opacity:.95; }
    .last-updated { font-weight:bold; color:#eee; margin-top:16px; }

    /* ---------- NEWS TICKER ---------- */
    #news-feed {
      background:#f8f5ec; padding:14px 20px; font-size:14px; color:#a07c3b;
      overflow:hidden; white-space:nowrap; border-top:1px solid #eee; border-bottom:1px solid #eee;
    }
    #ticker-text {
      display:inline-block; animation:scroll 40s linear infinite; padding-right:60px;
    }
    #news-feed:hover #ticker-text { animation-play-state:paused; }
    @keyframes scroll { 0% { transform:translateX(100%); } 100% { transform:translateX(-100%); } }

    /* ---------- TABS ---------- */
    .tabs {
      text-align:center; margin:40px 0; padding:0 20px;
    }
    .tab-button {
      background:#C1A875; color:#fff; border:none; padding:12px 20px;
      margin:6px; border-radius:8px; cursor:pointer; font-weight:bold;
      font-size:15px; transition:background .3s;
    }
    .tab-button:hover, .tab-button.active { background:#a07c3b; }

    /* ---------- TABLE ---------- */
    .table-container {
      max-width:1000px; margin:0 auto 60px; padding:0 20px; overflow-x:auto;
    }
    table {
      width:100%; border-collapse:collapse; background:#fff;
      box-shadow:0 8px 25px rgba(0,0,0,.08); border-radius:12px; overflow:hidden;
    }
    th {
      background:#f0ece6; padding:16px; text-align:left; font-weight:500;
      font-size:15px; color:#a07c3b;
    }
    td {
      padding:16px; border-bottom:1px solid #eee; font-size:14px;
    }
    tr:hover {
      background:#fdf8f0; transition:background .2s;
    }
    .trend {
      font-weight:bold; font-size:14px;
    }
    .trend.up { color:#e76f51; }
    .trend.down { color:#2a9d8f; }
    .trend.stable { color:#999; }

    /* ---------- ALLIYA FLOAT & MODAL ---------- */
    .alliya-float {
      position:fixed; right:20px; background:#C1A875; color:#fff;
      padding:14px 20px; border-radius:30px; cursor:pointer;
      box-shadow:0 4px 16px rgba(0,0,0,.2); display:flex; align-items:center;
      gap:10px; font-weight:bold; z-index:999; font-size:14px;
      transition:transform .3s, background .3s;
    }
    .alliya-float:hover { background:#a07c3b; transform:scale(1.05); }
    @media (max-width:768px) { .alliya-float { bottom:80px; } }
    @media (min-width:769px) { .alliya-float { bottom:20px; } }

    .modal {
      display:none; position:fixed; inset:0; background:rgba(0,0,0,.5);
      z-index:1000; justify-content:center; align-items:center; padding:20px;
    }
    .modal.active { display:flex; }
    .modal-content {
      background:#fff; border-radius:14px; width:90%; max-width:500px;
      padding:24px; position:relative; box-shadow:0 10px 30px rgba(0,0,0,.2);
    }
    .close { position:absolute; top:12px; right:16px; font-size:28px; cursor:pointer; color:#aaa; }
    .close:hover { color:#000; }

    .alliya-box h2 {
      display:flex; align-items:center; gap:10px; margin-bottom:18px; color:#a07c3b;
    }
    .alliya-box input {
      width:100%; padding:14px; border:1px solid #ddd; border-radius:8px;
      font-size:15px; transition:border .3s;
    }
    .alliya-box input:focus {
      outline:none; border-color:#C1A875; box-shadow:0 0 0 3px rgba(193,168,117,.2);
    }
    .alliya-box button {
      margin-top:12px; padding:12px 24px; background:#C1A875; color:#fff;
      border:none; border-radius:8px; cursor:pointer; font-weight:bold; width:100%;
    }
    .alliya-box button:hover { background:#a07c3b; }

    .suggestions {
      position:absolute; inset:100% 0 auto 0; background:#fff; border:1px solid #eee;
      border-radius:8px; max-height:160px; overflow-y:auto; z-index:10; margin-top:4px;
    }
    .suggestions div {
      padding:12px; cursor:pointer; border-bottom:1px solid #f0f0f0; font-size:14px;
    }
    .suggestions div:hover { background:#f8f5ec; }

    .reply {
      margin-top:16px; padding:14px; background:#f8f5ec; border-radius:8px;
      font-size:14px; text-align:center;
    }
    .reply a { color:#25D366; font-weight:bold; }

    /* ---------- FOOTER ---------- */
    footer {
      margin-top:80px; padding:24px; font-size:14px; color:#777; text-align:center;
    }
    .badge-footer {
      background:#C1A875; color:#fff; padding:6px 14px; border-radius:6px;
      font-weight:bold; font-size:.9rem; display:inline-block; margin-bottom:8px;
    }
    .contact-links a {
      color:#0056b3; text-decoration:none; margin:0 8px;
    }
    .contact-links a:hover { text-decoration:underline; }
    .contact-links .whatsapp i { color:#25D366; font-size:1.2em; }
  </style>
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar">
    <a href="/" class="logo">
      <img src="../grains-logo.png" alt="Logo" width="24"> Grains Hub
    </a>
    <ul class="nav-links">
      <li><a href="/">Home</a></li>
      <li><a href="/why">Why</a></li>
      <li><a href="/pulse/index.html" class="active">Pulse</a></li>
      <li><a href="/trust">Trust</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/shop">Shop</a></li>
    </ul>
    <div class="hamburger" onclick="toggleMenu()">
      <span></span><span></span><span></span>
    </div>
  </nav>

  <!-- Hero -->
  <header>
    <img src="../grains-logo.png" alt="Grains Hub Logo" />
    <h1>Market Pulse</h1>
    <p>Real-time grain prices from Jebel Ali, Al Ras & verified suppliers.</p>
    <p class="last-updated"><strong>Last updated:</strong> <span id="last-updated">Loading...</span></p>
  </header>

  <!-- News Ticker -->
  <div id="news-feed">
    <span id="ticker-text">Loading market signals...</span>
  </div>

  <!-- Tabs -->
  <div class="tabs">
    <button class="tab-button active" data-filter="All">All</button>
    <button class="tab-button" data-filter="India">India</button>
    <button class="tab-button" data-filter="Pakistan">Pakistan</button>
    <button class="tab-button" data-filter="Thailand">Thailand</button>
  </div>

  <!-- Table -->
  <div class="table-container">
    <table>
      <thead>
        <tr>
          <th>Product</th>
          <th>Origin</th>
          <th>Price (AED/kg)</th>
          <th>Trend</th>
          <th>Supplier</th>
        </tr>
      </thead>
      <tbody id="pulse-table">
        <!-- Filled by pulse.js -->
      </tbody>
    </table>
  </div>

  <!-- Alliya Float -->
  <div class="alliya-float" onclick="openModal()">
    <img src="../assets/img/alliya-icon.ico" alt="Alliya" width="24"> Ask Alliya
  </div>

  <!-- Alliya Modal -->
  <div id="modal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">×</span>
      <div class="alliya-box">
        <h2><img src="../assets/img/alliya-icon.ico" alt="Alliya" width="24"> Ask Alliya</h2>
        <div style="position:relative;">
          <input type="text" id="modalInput" placeholder="Ask about prices, FCL, trends..." oninput="suggest(this.value, true)" />
          <div id="modalSuggestions" class="suggestions"></div>
        </div>
        <button onclick="askAlliya(true)">Verify</button>
        <div id="modalReply" class="reply"></div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <div class="badge-footer">Microsoft Copilot Enabled</div><br>
    <div class="contact-links">
      <a href="mailto:letstalk@grains.ae">letstalk@grains.ae</a> |
      <a href="https://wa.me/971585521976" target="_blank" class="whatsapp">
        <i class="fab fa-whatsapp"></i> WhatsApp
      </a>
    </div>
    <p>© 2025 Grains Hub. All rights reserved.</p>
  </footer>

  <!-- Scripts -->
  <script src="pulse.js"></script>
  <script>
    // HAMBURGER MENU
    function toggleMenu() {
      const menu = document.querySelector('.nav-links');
      if (menu) menu.classList.toggle('active');
    }
    document.querySelector('.hamburger').addEventListener('click', toggleMenu);
    document.querySelectorAll('.nav-links a').forEach(link => {
      link.addEventListener('click', () => {
        document.querySelector('.nav-links').classList.remove('active');
      });
    });

    // TAB FILTERING
    document.querySelectorAll('.tab-button').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.tabOTTOM-button').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        const filter = btn.dataset.filter;
        window.filterPulse && window.filterPulse(filter);
      });
    });

    // ALLIYA MODAL
    function openModal() { document.getElementById('modal').classList.add('active'); }
    function closeModal() { document.getElementById('modal').classList.remove('active'); }

    // SUGGESTIONS
    const keywords = ['basmati 1121 price', 'irri 6 trend', 'FCL India cost', 'Jebel Ali arrivals', 'Thai white rice'];
    function suggest(val, modal = false) {
      const id = modal ? 'modalSuggestions' : 'suggestions';
      const box = document.getElementById(id); 
      if (!box) return;
      box.innerHTML = '';
      if (val.length < 2) return;
      keywords.filter(k => k.toLowerCase().includes(val.toLowerCase())).forEach(k => {
        const d = document.createElement('div');
        d.textContent = k; d.style.padding = '12px'; d.style.cursor = 'pointer';
        d.onclick = () => {
          const input = modal ? document.getElementById('modalInput') : document.getElementById('queryInput');
          if (input) input.value = k; box.innerHTML = ''; askAlliya(modal);
        };
        box.appendChild(d);
      });
    }

    async function askAlliya(modal = false) {
      const input = modal ? document.getElementById('modalInput') : document.getElementById('queryInput');
      const reply = modal ? document.getElementById('modalReply') : document.getElementById('replyBox');
      const q = input ? input.value.trim() : '';
      if (!q) return;
      reply.innerHTML = 'Verifying...';
      try {
        const res = await fetch(`https://grains-backend.onrender.com/api/alliya?q=${encodeURIComponent(q)}`);
        const data = await res.json();
        reply.innerHTML = data.reply || `Try WhatsApp: <a href="https://wa.me/971585521976?text=${encodeURIComponent(q)}">Message Us</a>`;
      } catch {
        reply.innerHTML = 'Try WhatsApp: <a href="https://wa.me/971585521976">Click Here</a>';
      }
    }
  </script>
</body>
</html>
